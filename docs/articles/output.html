<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Handling MODFLOW output • RMODFLOW</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Handling MODFLOW output">
<meta property="og:description" content="RMODFLOW">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-32706734-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-32706734-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RMODFLOW</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RMODFLOW.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/boundary_conditions.html">Boundary conditions</a>
    </li>
    <li>
      <a href="../articles/input_data_structure.html">Structure of input data</a>
    </li>
    <li>
      <a href="../articles/output.html">Handling MODFLOW output</a>
    </li>
    <li>
      <a href="../articles/parameters.html">MODFLOW parameters</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting in RMODFLOW</a>
    </li>
    <li>
      <a href="../articles/spatial.html">Spatial functions</a>
    </li>
    <li>
      <a href="../articles/top_level.html">Top-level functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rogiersbart/RMODFLOW/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="output_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Handling MODFLOW output</h1>
                        <h4 class="author">Cas Neyens</h4>
            
            <h4 class="date">2021-09-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rogiersbart/RMODFLOW/blob/master/vignettes/output.Rmd"><code>vignettes/output.Rmd</code></a></small>
      <div class="hidden name"><code>output.Rmd</code></div>

    </div>

    
    
<pre><code>## 
! {RMODFLOW} is still in its experimental lifecycle stage.
## 
! Use at your own risk, and submit issues here:
## 
! &lt;https://github.com/rogiersbart/RMODFLOW/issues&gt;</code></pre>
<p>A MODFLOW simulation can create multiple output files representing different variables. Examples are hydraulic heads (hed), drawdowns (ddn), cell-by-cell flow files (cbc), head-prediction files (hpr) and the listing file. The latter holds information on the simulation, execution and solver progress and a volumetric budget if defined by the Output-Control file (OC). This budget (bud) is often useful to look at.</p>
<p>These files can be written by MODFLOW in a variety of types and formats such as binary or ASCII. The internal structure of those files can also take various forms. RMODFLOW can handle all those formats, even the more obscure ones. In most cases, you’ll only need to supply a <code>dis</code> object to the <code>rmf_read_*</code> function. If the file is binary, you’ll need to know if it’s single or double precision depending on which MODFLOW executable was used. Most of the time, this would have been single precision.</p>
<div id="heads-drawdowns" class="section level2">
<h2 class="hasAnchor">
<a href="#heads-drawdowns" class="anchor"></a>Heads &amp; drawdowns</h2>
<p>To read simulated heads, use <code><a href="../reference/rmf_read_hed.html">rmf_read_hed()</a></code> (or its alias, <code><a href="../reference/rmf_read_hed.html">rmf_read_head()</a></code>). By default, <code>binary = TRUE</code> and <code>precision = 'single'</code>. If either of those arguments are incorrect, RMODFLOW will throw an error and suggests changing them. You can also supply a bas object to remove no-flow values or supply a <code>hdry</code> vector with values to set to <code>NA</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.dis"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_dis.html">rmf_read_dis</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">head</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.fhd"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rmf_read_hed.html">rmf_read_hed</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>, binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Drawdowns are similar to heads; use <code><a href="../reference/rmf_read_ddn.html">rmf_read_ddn()</a></code> or its alias <code><a href="../reference/rmf_read_ddn.html">rmf_read_drawdown()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ddn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.fdn"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rmf_read_ddn.html">rmf_read_ddn</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>, binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Heads and drawdowns are objects of class <code>hed</code> and <code>ddn</code>, respectively. Additionally, they are <code>rmf_4d_arrays</code>. Besides the default <code>rmf_array</code> attributes, these objects also have additional attributes related to the timing of each time step in the 4th dimensions of the array:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">head</span><span class="op">)</span>
<span class="co">#&gt;  'hed' num [1:45, 1:56, 1, 1:16] -1e+20 -1e+20 -1e+20 -1e+20 -1e+20 ...</span>
<span class="co">#&gt;  - attr(*, "nstp")= num [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  - attr(*, "totim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;  - attr(*, "pertim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;  - attr(*, "kper")= num [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  - attr(*, "kstp")= num [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  - attr(*, "dimlabels")= chr [1:4] "i" "j" "k" "l"</span></code></pre></div>
<p>To only read in certain time-steps, use the <code>timesteps</code> argument:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.fhd"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rmf_read_hed.html">rmf_read_hed</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>, binary <span class="op">=</span> <span class="cn">FALSE</span>, timesteps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">16</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  'hed' num [1:45, 1:56, 1, 1:2] -1e+20 -1e+20 -1e+20 -1e+20 -1e+20 ...</span>
<span class="co">#&gt;  - attr(*, "nstp")= num [1:2] 1 16</span>
<span class="co">#&gt;  - attr(*, "totim")= num [1:2] 293 180000</span>
<span class="co">#&gt;  - attr(*, "pertim")= num [1:2] 293 180000</span>
<span class="co">#&gt;  - attr(*, "kper")= num [1:2] 1 1</span>
<span class="co">#&gt;  - attr(*, "kstp")= num [1:2] 1 16</span>
<span class="co">#&gt;  - attr(*, "dimlabels")= chr [1:4] "i" "j" "k" "l"</span></code></pre></div>
<p>RMODFLOW provides S3 plotting methods for <code>hed</code> and <code>ddn</code> objects which act as wrappers for <code><a href="../reference/rmf_plot.rmf_4d_array.html">rmf_plot.rmf_4d_array()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read bas to remove no-flow values from plot.</span>
<span class="co"># Alternatively, this could have been done by supplying a bas object to rmf_read_hed</span>
<span class="va">bas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.bas"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rmf_read_bas.html">rmf_read_bas</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">head</span>, dis <span class="op">=</span> <span class="va">dis</span>, bas <span class="op">=</span> <span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; Warning: Plotting final time step results.</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>By default, the last time step is plotted. As with <code>rmf_plot.rmf_4d_array</code>, you can specify the <code>l</code> argument to subset the 4th dimension directly. Alternatively for <code>hed</code>, <code>ddn</code> and <code>cbc</code> objects, you can supply a <code>kper</code> and <code>kstp</code> argument to the respective <code>rmf_plot</code> call. For <code>hed</code> &amp; <code>ddn</code>, you can also supply the absolute time step number using <code>nstp</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">head</span>, dis <span class="op">=</span> <span class="va">dis</span>, bas <span class="op">=</span> <span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span>, kper <span class="op">=</span> <span class="fl">1</span>, kstp <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">head</span>, dis <span class="op">=</span> <span class="va">dis</span>, bas <span class="op">=</span> <span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span>, nstp <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<p>When plotting a <code>hed</code> object, a <code>saturated</code> argument can be supplied. By default, this is set to <code>TRUE</code>, which plots the saturated part of the grid when a cross-section plot is made. This can be useful if the potentiometric surface needs to be displayed. If set to <code>FALSE</code>, the cells are completely filled.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">'rocky-mountain-arsenal.nam'</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read.html">rmf_read</a></span><span class="op">(</span>output <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">head</span>, dis <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">dis</span>, bas <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">bas</span>, j <span class="op">=</span> <span class="fl">25</span>, grid <span class="op">=</span> <span class="cn">TRUE</span>, saturated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># default</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">head</span>, dis <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">dis</span>, bas <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">bas</span>, j <span class="op">=</span> <span class="fl">25</span>, grid <span class="op">=</span> <span class="cn">TRUE</span>, saturated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<p>It does not affect the mapview plot however:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># same results</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">head</span>, dis <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">dis</span>, bas <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span>, saturated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># default</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">head</span>, dis <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">dis</span>, bas <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span>, saturated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<p>We can obtain a water-table surface from the <code>hed</code> object using <code>rmf_convert_hed_to_water_table</code> which returns a <code>rmf_2d_array</code>, which also takes an <code>l</code> argument to subset the time step of the <code>hed</code> object (by default takes the last time step):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_convert_hed_to_water_table.html">rmf_convert_hed_to_water_table</a></span><span class="op">(</span><span class="va">head</span>, l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span>
<span class="co">#&gt;  'rmf_2d_array' num [1:45, 1:56] -1e+20 -1e+20 -1e+20 -1e+20 -1e+20 ...</span>
<span class="co">#&gt;  - attr(*, "dimlabels")= chr [1:2] "i" "j"</span></code></pre></div>
</div>
<div id="cell-by-cell-flow-budget" class="section level2">
<h2 class="hasAnchor">
<a href="#cell-by-cell-flow-budget" class="anchor"></a>Cell-by-cell flow budget</h2>
<p>A cbc file is always binary. Reading in such a file can be done by using the <code><a href="../reference/rmf_read_cbc.html">rmf_read_cbc()</a></code> function which returns a list with flow components, which are either <code>rmf_list</code> objects or <code>rmf_4d_array</code> objects.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.cbc"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_cbc.html">rmf_read_cbc</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">cbc</span><span class="op">)</span>
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ storage        : 'rmf_4d_array' num [1:45, 1:56, 1, 1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimlabels")= chr [1:4] "i" "j" "k" "l"</span>
<span class="co">#&gt;   ..- attr(*, "nstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "delt")= num [1:16] 293 414 586 828 1171 ...</span>
<span class="co">#&gt;   ..- attr(*, "totim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "pertim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "kper")= int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "kstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ flow_right_face: 'rmf_4d_array' num [1:45, 1:56, 1, 1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimlabels")= chr [1:4] "i" "j" "k" "l"</span>
<span class="co">#&gt;   ..- attr(*, "nstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "delt")= num [1:16] 293 414 586 828 1171 ...</span>
<span class="co">#&gt;   ..- attr(*, "totim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "pertim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "kper")= int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "kstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ flow_front_face: 'rmf_4d_array' num [1:45, 1:56, 1, 1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimlabels")= chr [1:4] "i" "j" "k" "l"</span>
<span class="co">#&gt;   ..- attr(*, "nstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "delt")= num [1:16] 293 414 586 828 1171 ...</span>
<span class="co">#&gt;   ..- attr(*, "totim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "pertim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "kper")= int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "kstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ wells          :Classes 'rmf_list' and 'data.frame':  16 obs. of  8 variables:</span>
<span class="co">#&gt;   ..$ k    : num [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ i    : num [1:16] 30 30 30 30 30 30 30 30 30 30 ...</span>
<span class="co">#&gt;   ..$ j    : num [1:16] 33 33 33 33 33 33 33 33 33 33 ...</span>
<span class="co">#&gt;   ..$ value: num [1:16] 0.963 0.963 0.963 0.963 0.963 ...</span>
<span class="co">#&gt;   ..$ iface: num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ nstp : int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..$ kper : int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ kstp : int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "kstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "kper")= int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "nstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "pertim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "totim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "delt")= num [1:16] 293 414 586 828 1171 ...</span>
<span class="co">#&gt;   ..- attr(*, "ctmp")=List of 16</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;  $ river_leakage  :Classes 'rmf_list' and 'data.frame':  1072 obs. of  8 variables:</span>
<span class="co">#&gt;   ..$ k    : num [1:1072] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ i    : num [1:1072] 18 19 19 19 19 20 20 20 21 21 ...</span>
<span class="co">#&gt;   ..$ j    : num [1:1072] 1 1 2 3 4 4 5 6 6 7 ...</span>
<span class="co">#&gt;   ..$ value: num [1:1072] -1.07e-06 0.00 -1.17e-06 -1.27e-06 -1.46e-06 ...</span>
<span class="co">#&gt;   ..$ iface: num [1:1072] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ nstp : int [1:1072] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ kper : int [1:1072] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ kstp : int [1:1072] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "kstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "kper")= int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "nstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "pertim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "totim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "delt")= num [1:16] 293 414 586 828 1171 ...</span>
<span class="co">#&gt;   ..- attr(*, "ctmp")=List of 16</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;  - attr(*, "class")= chr "cbc"</span></code></pre></div>
<p>A <code>fluxes</code> argument can be specified to only read in certain fluxes (see <code><a href="../reference/rmf_read_cbc.html">help(rmf_read_cbc)</a></code> for details on which fluxes can be read). By default, all fluxes are read.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.cbc"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_cbc.html">rmf_read_cbc</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>, fluxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"wells"</span>, <span class="st">"flow_right_face"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ flow_right_face: 'rmf_4d_array' num [1:45, 1:56, 1, 1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimlabels")= chr [1:4] "i" "j" "k" "l"</span>
<span class="co">#&gt;   ..- attr(*, "nstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "delt")= num [1:16] 293 414 586 828 1171 ...</span>
<span class="co">#&gt;   ..- attr(*, "totim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "pertim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "kper")= int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "kstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ wells          :Classes 'rmf_list' and 'data.frame':  16 obs. of  8 variables:</span>
<span class="co">#&gt;   ..$ k    : num [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ i    : num [1:16] 30 30 30 30 30 30 30 30 30 30 ...</span>
<span class="co">#&gt;   ..$ j    : num [1:16] 33 33 33 33 33 33 33 33 33 33 ...</span>
<span class="co">#&gt;   ..$ value: num [1:16] 0.963 0.963 0.963 0.963 0.963 ...</span>
<span class="co">#&gt;   ..$ iface: num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ nstp : int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..$ kper : int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ kstp : int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "kstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "kper")= int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..- attr(*, "nstp")= int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..- attr(*, "pertim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "totim")= num [1:16] 293 707 1293 2121 3292 ...</span>
<span class="co">#&gt;   ..- attr(*, "delt")= num [1:16] 293 414 586 828 1171 ...</span>
<span class="co">#&gt;   ..- attr(*, "ctmp")=List of 16</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;   .. ..$ : chr "iface"</span>
<span class="co">#&gt;  - attr(*, "class")= chr "cbc"</span></code></pre></div>
<p>Similar to heads and drawdowns, RMODFLOW has a <code><a href="../reference/rmf_plot.cbc.html">rmf_plot.cbc()</a></code> function which acts as a wrapper around either <code><a href="../reference/rmf_plot.rmf_list.html">rmf_plot.rmf_list()</a></code> or <code><a href="../reference/rmf_plot.rmf_4d_array.html">rmf_plot.rmf_4d_array()</a></code> depending on which flux component to plot as defined by the <code>flux</code> argument:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">cbc</span>, dis <span class="op">=</span> <span class="va">dis</span>, bas <span class="op">=</span> <span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span>, flux <span class="op">=</span> <span class="st">"storage"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Plotting final time step results.</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">cbc</span>, dis <span class="op">=</span> <span class="va">dis</span>, bas <span class="op">=</span> <span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span>, flux <span class="op">=</span> <span class="st">"river_leakage"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Plotting final time step results.</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<p>In addition to the available fluxes in the cbc object, the <code>flux</code> argument can also be <code>darcy</code> which will calculate Darcy fluxes using <code><a href="../reference/rmf_convert_cbc_to_darcy.html">rmf_convert_cbc_to_darcy()</a></code>. This is useful in conjunction with the <code>type = 'vector'</code> argument:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">head</span>, dis <span class="op">=</span> <span class="va">dis</span>, bas <span class="op">=</span> <span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span>, l <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">cbc</span>, dis <span class="op">=</span> <span class="va">dis</span>, bas <span class="op">=</span> <span class="va">bas</span>, k <span class="op">=</span> <span class="fl">1</span>, l <span class="op">=</span> <span class="fl">16</span>, flux <span class="op">=</span> <span class="st">"darcy"</span>, type <span class="op">=</span> <span class="st">"vector"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1537 rows containing non-finite values (stat_quiver).</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="volumetric-budget" class="section level2">
<h2 class="hasAnchor">
<a href="#volumetric-budget" class="anchor"></a>Volumetric budget</h2>
<p>Useful as the cbc object may be, it is not always straightforward to obtain a mass balance (i.e. volumetric budget) from it. This is written to the listing file if specified by the OC file. To read in the volumetric budget from a listing file, use <code><a href="../reference/rmf_read_bud.html">rmf_read_bud()</a></code> which returns a <code>bud</code> object which is a list with two data.frames: one holding the volumetric rates and one with the cumulative volumes. <strong>Note: in previous versions of RMODFLOW, <code>rmf_read_bud</code> was used to read in the cell-by-cell flow object; this is therefore a breaking change</strong>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bud</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.lst"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_bud.html">rmf_read_bud</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">bud</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ cumulative:'data.frame':  16 obs. of  14 variables:</span>
<span class="co">#&gt;   ..$ kstp             : num [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..$ kper             : num [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ storage_in       : num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ constant_head_in : num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ wells_in         : num [1:16] 282 681 1245 2043 3170 ...</span>
<span class="co">#&gt;   ..$ river_leakage_in : num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ total_in         : num [1:16] 282 681 1245 2043 3170 ...</span>
<span class="co">#&gt;   ..$ storage_out      : num [1:16] 277 662 1192 1914 2884 ...</span>
<span class="co">#&gt;   ..$ constant_head_out: num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ wells_out        : num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ river_leakage_out: num [1:16] 4.47 18.51 52.42 127.17 284.2 ...</span>
<span class="co">#&gt;   ..$ total_out        : num [1:16] 282 680 1244 2041 3169 ...</span>
<span class="co">#&gt;   ..$ difference       : num [1:16] 0.309 0.695 1.049 1.455 1.732 ...</span>
<span class="co">#&gt;   ..$ discrepancy      : num [1:16] 0.11 0.1 0.08 0.07 0.05 0.04 0.03 0.03 0.02 0.02 ...</span>
<span class="co">#&gt;  $ rates     :'data.frame':  16 obs. of  14 variables:</span>
<span class="co">#&gt;   ..$ kstp             : num [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..$ kper             : num [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;   ..$ storage_in       : num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ constant_head_in : num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ wells_in         : num [1:16] 0.963 0.963 0.963 0.963 0.963 0.963 0.963 0.963 0.963 0.963 ...</span>
<span class="co">#&gt;   ..$ river_leakage_in : num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ total_in         : num [1:16] 0.963 0.963 0.963 0.963 0.963 0.963 0.963 0.963 0.963 0.963 ...</span>
<span class="co">#&gt;   ..$ storage_out      : num [1:16] 0.947 0.928 0.904 0.872 0.829 ...</span>
<span class="co">#&gt;   ..$ constant_head_out: num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ wells_out        : num [1:16] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ river_leakage_out: num [1:16] 0.0153 0.0339 0.0579 0.0902 0.1341 ...</span>
<span class="co">#&gt;   ..$ total_out        : num [1:16] 0.962 0.962 0.962 0.963 0.963 ...</span>
<span class="co">#&gt;   ..$ difference       : num [1:16] 0.001054 0.000932 0.000605 0.000489 0.000237 ...</span>
<span class="co">#&gt;   ..$ discrepancy      : num [1:16] 0.11 0.1 0.06 0.05 0.02 0.02 0.01 0.01 0.01 0.02 ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr "bud"</span></code></pre></div>
<p>Plotting a <code>bud</code> object can be done with <code><a href="../reference/rmf_plot.bud.html">rmf_plot.bud()</a></code> which by default plots gross volumetric rates for all fluxes:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">bud</span>, dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>You can select fluxes with the <code>fluxes</code> argument,</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">bud</span>, dis <span class="op">=</span> <span class="va">dis</span>, fluxes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"wells"</span>, <span class="st">"river_leakage"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>plot net fluxes by setting <code>net = TRUE</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">bud</span>, dis <span class="op">=</span> <span class="va">dis</span>, net <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>and select between rates, cumulative, total, difference or discrepancy using the <code>what</code> argument.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">bud</span>, dis <span class="op">=</span> <span class="va">dis</span>, what <span class="op">=</span> <span class="st">"cumulative"</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">bud</span>, dis <span class="op">=</span> <span class="va">dis</span>, what <span class="op">=</span> <span class="st">"discrepancy"</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-18-2.png" width="700"></p>
<p>By default, <code>rmf_plot.bud</code> uses <code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">ggplot2::geom_area</a></code>. You can change this to a bar plot (<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">ggplot2::geom_col</a></code>) by setting <code>type = 'bar'</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">bud</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>this is especially useful when plotting only a few time steps:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">bud</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"bar"</span>, timesteps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>and is the default if the simulation only has a single time step (e.g. a steady-state simulation):</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dis_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"example-model.dis"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_dis.html">rmf_read_dis</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">bud_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"example-model.lst"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_bud.html">rmf_read_bud</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">bud_ss</span>, dis <span class="op">=</span> <span class="va">dis_ss</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div id="head-prediction-file" class="section level2">
<h2 class="hasAnchor">
<a href="#head-prediction-file" class="anchor"></a>Head-prediction file</h2>
<p>If a HOB file is present with a IUHOBS value larger than zero, a head-prediction file will be saved to disk by the MODFLOW simulation. This file holds the observed hydraulic head values, their simulated equivalents and the observation names. It can be read by RMODFLOW using <code><a href="../reference/rmf_read_hpr.html">rmf_read_hpr()</a></code> which returns a data.frame of class <code>hpr</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.hob_out"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_hpr.html">rmf_read_hpr</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">hpr</span><span class="op">)</span>
<span class="co">#&gt; Classes 'hpr' and 'data.frame':  27 obs. of  4 variables:</span>
<span class="co">#&gt;  $ simulated: num  0.0716 0.0716 0.0992 0.1844 0.2971 ...</span>
<span class="co">#&gt;  $ observed : num  0.17 0.26 0.33 0.48 0.57 ...</span>
<span class="co">#&gt;  $ name     : chr  "ObsWell1__1" "ObsWell1__2" "ObsWell1__3" "ObsWell1__4" ...</span>
<span class="co">#&gt;  $ residual : num  -0.0984 -0.1884 -0.2308 -0.2956 -0.2729 ...</span></code></pre></div>
<p><code>rmf_read_hpr</code> adds a residual column which is the difference between simulated and observed values.</p>
<p>To plot a hpr object, you can use <code><a href="../reference/rmf_plot.hpr.html">rmf_plot.hpr()</a></code> which by default plots a scatter plot:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">hpr</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>A histogram or residual plot can be made by changing the <code>type</code> argument:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">hpr</span>, type <span class="op">=</span> <span class="st">"histogram"</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">hpr</span>, type <span class="op">=</span> <span class="st">"residual"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x.bottom <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="output_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>Goodness-of-fit statistics can be obtained with the <code><a href="../reference/rmf_performance.html">rmf_performance()</a></code> function:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_performance.html">rmf_performance</a></span><span class="op">(</span><span class="va">hpr</span><span class="op">)</span>
<span class="co">#&gt; Warning: 'rNSE' can not be computed: some elements in 'obs' are zero !</span>
<span class="co">#&gt; Warning: 'rd' can not be computed: some elements in 'obs' are zero !</span>
<span class="co">#&gt;      me  mae  mse rmse pbias  nse   r2  kge  ssq</span>
<span class="co">#&gt; 1 -0.02 0.15 0.03 0.18  -5.1 0.77 0.78 0.86 0.88</span></code></pre></div>
</div>
<div id="output-control" class="section level2">
<h2 class="hasAnchor">
<a href="#output-control" class="anchor"></a>Output-Control</h2>
<p>In MODFLOW, the Output-Control file (OC) controls the type and timing of saving output to disk and printing output to the listing file. RMODFLOW can read, write and create an OC object.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.oc"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_oc.html">rmf_read_oc</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">oc</span><span class="op">)</span>
<span class="co">#&gt; List of 22</span>
<span class="co">#&gt;  $ ibouun        : logi NA</span>
<span class="co">#&gt;  $ cboufm        : logi NA</span>
<span class="co">#&gt;  $ iddnun        : num 38</span>
<span class="co">#&gt;  $ cddnfm        : chr "(10(1X1PE13.5))"</span>
<span class="co">#&gt;  $ iddnfm        : logi NA</span>
<span class="co">#&gt;  $ ihedun        : num 37</span>
<span class="co">#&gt;  $ chedfm        : chr "(10(1X1PE13.5))"</span>
<span class="co">#&gt;  $ ihedfm        : logi NA</span>
<span class="co">#&gt;  $ ibound_label  : logi FALSE</span>
<span class="co">#&gt;  $ drawdown_label: logi TRUE</span>
<span class="co">#&gt;  $ head_label    : logi TRUE</span>
<span class="co">#&gt;  $ aux           : logi TRUE</span>
<span class="co">#&gt;  $ compact_budget: logi TRUE</span>
<span class="co">#&gt;  $ print_head    : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ print_drawdown: logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_head     : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_drawdown : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_ibound   : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ iperoc        : num [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ itsoc         : num [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ save_budget   : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ print_budget  : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  - attr(*, "comment")= chr " Output Control file created on 2017-05-30 by ModelMuse version 3.9.0.0."</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "oc" "rmf_package"</span></code></pre></div>
<p>When creating an OC object, you might be overwhelmed by the amount of input arguments. This is in large part because a MODFLOW OC file can be specified in two ways: either with words or numeric codes. RMODFLOW keeps true to these options but uses words by default.</p>
<p>The OC object controls saving of following variables to disk: head, drawdown, ibound &amp; cell-by-cell-flows. It also controls the printing of following variables to the listing file: head, drawdown &amp; volumetric budget.</p>
<p>By default, an OC object created by RMODFLOW specifies the following:</p>
<ul>
<li>Save heads at every time step</li>
<li>Save cell-by-cell flows at every time step</li>
<li>Print the volumetric budget to the listing file at every time step</li>
<li>The head file is specified as binary</li>
<li>Labels are written to the corresponding output files</li>
<li>The compact budget option for the cbc file is active</li>
<li>The aux option for compact budget is active</li>
</ul>
<p>Remember that the cbc file is always binary.</p>
<p>To alter any of these, use the respective <code>save_*</code> or <code>print_*</code> arguments. These are logical values, either of length 1 meaning they are the same for all time steps, or a single value for every time step.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_create_oc.html">rmf_create_oc</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>, print_head <span class="op">=</span> <span class="cn">TRUE</span>, 
              save_head <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nstp</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nstp</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; List of 22</span>
<span class="co">#&gt;  $ ihedfm        : num 0</span>
<span class="co">#&gt;  $ chedfm        : logi NA</span>
<span class="co">#&gt;  $ ihedun        : num 666</span>
<span class="co">#&gt;  $ iddnfm        : logi NA</span>
<span class="co">#&gt;  $ cddnfm        : logi NA</span>
<span class="co">#&gt;  $ iddnun        : logi NA</span>
<span class="co">#&gt;  $ cboufm        : logi NA</span>
<span class="co">#&gt;  $ ibouun        : logi NA</span>
<span class="co">#&gt;  $ compact_budget: logi TRUE</span>
<span class="co">#&gt;  $ aux           : logi TRUE</span>
<span class="co">#&gt;  $ head_label    : logi TRUE</span>
<span class="co">#&gt;  $ drawdown_label: logi TRUE</span>
<span class="co">#&gt;  $ ibound_label  : logi TRUE</span>
<span class="co">#&gt;  $ iperoc        : int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ itsoc         : int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ print_head    : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ print_drawdown: logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ print_budget  : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_head     : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_drawdown : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_ibound   : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_budget   : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "oc" "rmf_package"</span></code></pre></div>
<p>To set the unit numbers on which the output is saved, use the ihedun (default 666), iddnun (default 667) &amp; ibouun (default 668) values for heads, drawdowns and ibound output, respectively. The unit number for cell-by-cell flows is set in the flow and boundary condition packages.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_create_oc.html">rmf_create_oc</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>,
              ihedun <span class="op">=</span> <span class="fl">50</span>,
              save_drawdown <span class="op">=</span> <span class="cn">TRUE</span>, iddnun <span class="op">=</span> <span class="fl">60</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; List of 22</span>
<span class="co">#&gt;  $ ihedfm        : logi NA</span>
<span class="co">#&gt;  $ chedfm        : logi NA</span>
<span class="co">#&gt;  $ ihedun        : num 50</span>
<span class="co">#&gt;  $ iddnfm        : logi NA</span>
<span class="co">#&gt;  $ cddnfm        : logi NA</span>
<span class="co">#&gt;  $ iddnun        : num 60</span>
<span class="co">#&gt;  $ cboufm        : logi NA</span>
<span class="co">#&gt;  $ ibouun        : logi NA</span>
<span class="co">#&gt;  $ compact_budget: logi TRUE</span>
<span class="co">#&gt;  $ aux           : logi TRUE</span>
<span class="co">#&gt;  $ head_label    : logi TRUE</span>
<span class="co">#&gt;  $ drawdown_label: logi TRUE</span>
<span class="co">#&gt;  $ ibound_label  : logi TRUE</span>
<span class="co">#&gt;  $ iperoc        : int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ itsoc         : int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ print_head    : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ print_drawdown: logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ print_budget  : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_head     : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_drawdown : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_ibound   : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_budget   : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "oc" "rmf_package"</span></code></pre></div>
<p>To save ASCII files, set the chedfm, cddnfm or cboufm values to proper FORTRAN formats enclosed in parenthesis containing no more than 20 characters. These FORTRAN formats can be found in the <a href="https://water.usgs.gov/ogw/modflow/MODFLOW-2005-Guide/index.html?oc.htm">MODFLOW-2005 manual</a>. In RMODFLOW, you can alternatively specify integer codes for the save formats, similar to the print formats. RMODFLOW will convert these to the proper FORTRAN format. Note that ASCII files are typically larger than binary files.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_create_oc.html">rmf_create_oc</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>, chedfm <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; List of 22</span>
<span class="co">#&gt;  $ ihedfm        : logi NA</span>
<span class="co">#&gt;  $ chedfm        : chr "(10G11.4)"</span>
<span class="co">#&gt;  $ ihedun        : num 666</span>
<span class="co">#&gt;  $ iddnfm        : logi NA</span>
<span class="co">#&gt;  $ cddnfm        : logi NA</span>
<span class="co">#&gt;  $ iddnun        : logi NA</span>
<span class="co">#&gt;  $ cboufm        : logi NA</span>
<span class="co">#&gt;  $ ibouun        : logi NA</span>
<span class="co">#&gt;  $ compact_budget: logi TRUE</span>
<span class="co">#&gt;  $ aux           : logi TRUE</span>
<span class="co">#&gt;  $ head_label    : logi TRUE</span>
<span class="co">#&gt;  $ drawdown_label: logi TRUE</span>
<span class="co">#&gt;  $ ibound_label  : logi TRUE</span>
<span class="co">#&gt;  $ iperoc        : int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ itsoc         : int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ print_head    : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ print_drawdown: logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ print_budget  : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_head     : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_drawdown : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_ibound   : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_budget   : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "oc" "rmf_package"</span></code></pre></div>
<p>Let’s say, we want to save drawdowns in an ASCII file (setting cddnfm to a FORTRAN format or positive integer) on unit number 50 (default is 667 for drawdown), not save heads, and print volumetric budget to the listing file every other time step:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_oc.html">rmf_create_oc</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>,
                    save_drawdown <span class="op">=</span> <span class="cn">TRUE</span>, cddnfm <span class="op">=</span> <span class="fl">0</span>, iddnun <span class="op">=</span> <span class="fl">50</span>, 
                    save_head <span class="op">=</span> <span class="cn">FALSE</span>, 
                    print_budget <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nstp</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">oc</span><span class="op">)</span>
<span class="co">#&gt; List of 22</span>
<span class="co">#&gt;  $ ihedfm        : logi NA</span>
<span class="co">#&gt;  $ chedfm        : logi NA</span>
<span class="co">#&gt;  $ ihedun        : logi NA</span>
<span class="co">#&gt;  $ iddnfm        : logi NA</span>
<span class="co">#&gt;  $ cddnfm        : chr "(10G11.4)"</span>
<span class="co">#&gt;  $ iddnun        : num 50</span>
<span class="co">#&gt;  $ cboufm        : logi NA</span>
<span class="co">#&gt;  $ ibouun        : logi NA</span>
<span class="co">#&gt;  $ compact_budget: logi TRUE</span>
<span class="co">#&gt;  $ aux           : logi TRUE</span>
<span class="co">#&gt;  $ head_label    : logi TRUE</span>
<span class="co">#&gt;  $ drawdown_label: logi TRUE</span>
<span class="co">#&gt;  $ ibound_label  : logi TRUE</span>
<span class="co">#&gt;  $ iperoc        : int [1:16] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ itsoc         : int [1:16] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ print_head    : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ print_drawdown: logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ print_budget  : logi [1:16] FALSE TRUE FALSE TRUE FALSE TRUE ...</span>
<span class="co">#&gt;  $ save_head     : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_drawdown : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  $ save_ibound   : logi [1:16] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ save_budget   : logi [1:16] TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "oc" "rmf_package"</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rogiersbart.github.io/">Bart Rogiers</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
