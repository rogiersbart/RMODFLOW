<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting in RMODFLOW • RMODFLOW</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting in RMODFLOW">
<meta property="og:description" content="RMODFLOW">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-32706734-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-32706734-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RMODFLOW</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RMODFLOW.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/boundary_conditions.html">Boundary conditions</a>
    </li>
    <li>
      <a href="../articles/input_data_structure.html">Structure of input data</a>
    </li>
    <li>
      <a href="../articles/output.html">Handling MODFLOW output</a>
    </li>
    <li>
      <a href="../articles/parameters.html">MODFLOW parameters</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting in RMODFLOW</a>
    </li>
    <li>
      <a href="../articles/spatial.html">Spatial functions</a>
    </li>
    <li>
      <a href="../articles/top_level.html">Top-level functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rogiersbart/RMODFLOW/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="plotting_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting in RMODFLOW</h1>
                        <h4 class="author">Cas Neyens</h4>
            
            <h4 class="date">2021-09-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rogiersbart/RMODFLOW/blob/master/vignettes/plotting.Rmd"><code>vignettes/plotting.Rmd</code></a></small>
      <div class="hidden name"><code>plotting.Rmd</code></div>

    </div>

    
    
<pre><code>## 
! {RMODFLOW} is still in its experimental lifecycle stage.
## 
! Use at your own risk, and submit issues here:
## 
! &lt;https://github.com/rogiersbart/RMODFLOW/issues&gt;</code></pre>
<div id="plotting-basic-rmodflow-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-basic-rmodflow-objects" class="anchor"></a>Plotting basic RMODFLOW objects</h1>
<p>RMODFLOW provides S3 plotting methods through the <code><a href="../reference/rmf_plot.html">rmf_plot()</a></code> functions. These return a <code>ggplot2</code> layer and are therefore subjected to the full capabilities of the <code>ggplot2</code> package.</p>
<p>For almost all <code>rmf_plot</code> functions, you’ll need a RMODFLOW <code>dis</code> object. There are <code>rmf_plot</code> functions for a bunch of RMODFLOW classes but at their core they most of the time wrangle the object into a <code>rmf_2d_array</code> or <code>rmf_3d_array</code> and call the respective <code>rmf_plot</code> function on those objects.</p>
<p>We’ll start by explaining plotting the basic RMODFLOW classes, i.e. the <code>rmf_arrays</code> and <code>rmf_list</code>. You can read more about these types of objects in <a href="input_data_structure.html">the vignette on the structure of input data</a>.</p>
<div id="rmf_2d_array" class="section level3">
<h3 class="hasAnchor">
<a href="#rmf_2d_array" class="anchor"></a><code>rmf_2d_array</code>
</h3>
<p>The <code><a href="../reference/rmf_plot.rmf_2d_array.html">rmf_plot.rmf_2d_array()</a></code> plotting function plots a <code>rmf_2d_array</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_model.html">rmf_example_model</a></span><span class="op">(</span><span class="st">"example-model.dis"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rmf_read_dis.html">rmf_read_dis</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>The <code>type</code> argument controls the plot type. Possible values are <code>fill</code> (default), <code>factor</code>, <code>grid</code>, <code>contour</code> and <code>vector</code>. At this point, it is good to note that <code>fill</code> and <code>factor</code> use the fill aesthetic from <code>ggplot2</code> whereas <code>grid</code>, <code>contour</code> and <code>vector</code> use the colour aesthetic.</p>
<div id="factor" class="section level4">
<h4 class="hasAnchor">
<a href="#factor" class="anchor"></a>Factor</h4>
<p>The <code>factor</code> type is useful for discrete data. It coerces the values in the <code>rmf_2d_array</code> into factors. Plotting can therefore be slow if the array holds many distinct values. In that case however, you should consider using the <code>fill</code> type. You can supply a <code>levels</code> argument to label the legend wich is a character vector with the labels. If not named, the values in this vector are assigned to the sorted array factor levels.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_array.html">rmf_create_array</a></span><span class="op">(</span><span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nrow</span>, <span class="va">dis</span><span class="op">$</span><span class="va">ncol</span><span class="op">)</span><span class="op">)</span>
<span class="va">ds</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">ds</span><span class="op">[</span>, <span class="va">dis</span><span class="op">$</span><span class="va">ncol</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">ds</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"factor"</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># not named; labels are assigned to sorted factor levels </span>
<span class="va">lv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span><span class="op">)</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">ds</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"factor"</span>, levels <span class="op">=</span> <span class="va">lv</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># named</span>
<span class="va">lv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Positive"</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="st">"Zero"</span>, <span class="st">"-1"</span> <span class="op">=</span> <span class="st">"Negative"</span><span class="op">)</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">ds</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"factor"</span>, levels <span class="op">=</span> <span class="va">lv</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
</div>
<div id="grid" class="section level4">
<h4 class="hasAnchor">
<a href="#grid" class="anchor"></a>Grid</h4>
<p>The <code>grid</code> type will only plot the gridlines.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"grid"</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>To plot gridlines on top of an existing plot, the quickest way is to set the <code>gridlines</code> argument to <code>TRUE</code>. Alternatively, you can supply a character argument to plot coloured gridlines</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, gridlines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, gridlines <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
</div>
<div id="contour" class="section level4">
<h4 class="hasAnchor">
<a href="#contour" class="anchor"></a>Contour</h4>
<p>The <code>contour</code> type will plot contour lines. You can tweak the <code>binwidth</code> argument to your liking (the defaults might not always work). Additionally, the labels can be removed by setting <code>label = FALSE</code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"contour"</span>, binwidth <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
</div>
<div id="vector" class="section level4">
<h4 class="hasAnchor">
<a href="#vector" class="anchor"></a>Vector</h4>
<p>The <code>vector</code> type will calculate a gradient using <code><a href="../reference/rmf_gradient.html">rmf_gradient()</a></code> and will plot the vector arrows using <code>ggquiver</code>. Note that RMODFLOW assumes the array contains scalars to calculate the gradient. To supply your own vector values, you can set the <code>uvw</code> argument which is a named list with u and v components (and w for 3d) which are 2d (3d) arrays with the gradient values in the x and y (&amp; z) directions.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"vector"</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"vector"</span>, vecint <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_array.html">rmf_create_array</a></span><span class="op">(</span><span class="fl">0.5</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nrow</span>, <span class="va">dis</span><span class="op">$</span><span class="va">ncol</span><span class="op">)</span><span class="op">)</span>
<span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_array.html">rmf_create_array</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nrow</span>, <span class="va">dis</span><span class="op">$</span><span class="va">ncol</span><span class="op">)</span><span class="op">)</span>
<span class="va">uvw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>u <span class="op">=</span> <span class="va">u</span>, v <span class="op">=</span> <span class="va">v</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"vector"</span>, uvw <span class="op">=</span> <span class="va">uvw</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-6-3.png" width="700"></p>
</div>
<div id="colour-palette" class="section level4">
<h4 class="hasAnchor">
<a href="#colour-palette" class="anchor"></a>Colour palette</h4>
<p>You can specify your own colour palette and the number of colours with <code>colour_palette</code> and <code>nlevels</code> (7 by default). For type <code>grid</code>, no colour scale can be supplied. For type <code>contour</code> and type <code>vector</code>, the default colour scale is <code>'black'</code> which is not a scale at all.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, colour_palette <span class="op">=</span> <span class="va">heat.colors</span>, nlevels <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, colour_palette <span class="op">=</span> <span class="va">heat.colors</span>, nlevels <span class="op">=</span> <span class="fl">8</span>, type <span class="op">=</span> <span class="st">'vector'</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
</div>
<div id="mask-bas" class="section level4">
<h4 class="hasAnchor">
<a href="#mask-bas" class="anchor"></a>Mask &amp; bas</h4>
<p>You can supply a logical array as the <code>mask</code> argument to only include certain parts of the grid. If not supplied, the entire grid is plotted. If a <code>bas</code> object is supplied, the ibound array is used as a <code>mask</code> object.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_array.html">rmf_create_array</a></span><span class="op">(</span><span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nrow</span>, <span class="va">dis</span><span class="op">$</span><span class="va">ncol</span><span class="op">)</span><span class="op">)</span>
<span class="va">mask</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">dis</span><span class="op">$</span><span class="va">nrow</span><span class="op">/</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, mask <span class="op">=</span> <span class="va">mask</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># water-supply problem</span>
<span class="va">dis_ws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.dis"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_dis.html">rmf_read_dis</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">bas_ws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.bas"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_bas.html">rmf_read_bas</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis_ws</span><span class="op">)</span>

<span class="co"># without bas</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis_ws</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis_ws</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># with bas</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis_ws</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis_ws</span>, bas <span class="op">=</span> <span class="va">bas_ws</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
</div>
<div id="adding-plot-layers" class="section level4">
<h4 class="hasAnchor">
<a href="#adding-plot-layers" class="anchor"></a>Adding plot layers</h4>
<p>Since all <code>rmf_plot</code> functions return a <code>ggplot2</code> layer, you can add them on top of each other. Just remember to set <code>add = TRUE</code> in all added layers. You can of course add other <code>ggplot2</code> layers besides the <code>rmf_plot</code> results.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"vector"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div id="legend" class="section level4">
<h4 class="hasAnchor">
<a href="#legend" class="anchor"></a>Legend</h4>
<p>By default, the legend is only active when <code>type</code> is <code>fill</code> or <code>factor</code> for the first plotting layer. To add the legend, set <code>legend = TRUE</code>. To supply a legend title, just set the <code>legend</code> argument as such:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, legend <span class="op">=</span> <span class="st">"Topography (m)"</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># This also works for added layers:</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">dis</span>, type <span class="op">=</span> <span class="st">"vector"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, colour_palette <span class="op">=</span> <span class="va">heat.colors</span>, legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
</div>
<div id="projection" class="section level4">
<h4 class="hasAnchor">
<a href="#projection" class="anchor"></a>Projection</h4>
<p>Waiting for update on spatial code</p>
</div>
<div id="d-plotting" class="section level4">
<h4 class="hasAnchor">
<a href="#d-plotting" class="anchor"></a>3D plotting</h4>
<p>3D plotting: currently being moved around in the code, possibly with different function <code>rmf_render</code>.</p>
</div>
</div>
<div id="rmf_3d_array" class="section level3">
<h3 class="hasAnchor">
<a href="#rmf_3d_array" class="anchor"></a><code>rmf_3d_array</code>
</h3>
<p>Plotting a <code>rmf_3d_array</code> with <code><a href="../reference/rmf_plot.rmf_3d_array.html">rmf_plot.rmf_3d_array()</a></code> uses mostly the same functionality as plotting a <code>rmf_2d_array</code>. The big difference being that now you <strong>must</strong> supply either a <code>i</code>, <code>j</code> or <code>k</code> integer argument which subsets the <code>rmf_3d_array</code>. If <code>k</code> is supplied, the subsetted array is passed to <code>rmf_2d_array</code>. If <code>i</code> or <code>j</code> are supplied, a cross-section is plotted:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">botm</span>, dis <span class="op">=</span> <span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">botm</span>, dis <span class="op">=</span> <span class="va">dis</span>, j <span class="op">=</span> <span class="fl">5</span>, gridlines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
<p>All other arguments discussed with plotting <code>rmf_2d_arrays</code> can still be used. Note however, that when adding plot layers, they must have the same subset otherwise the plots make no sense or might error out. RMODFLOW does not have a check for this.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># layer 1 + column 5</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">botm</span>, dis <span class="op">=</span> <span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">botm</span>, dis <span class="op">=</span> <span class="va">dis</span>, j <span class="op">=</span> <span class="fl">5</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="rmf_4d_array" class="section level3">
<h3 class="hasAnchor">
<a href="#rmf_4d_array" class="anchor"></a><code>rmf_4d_array</code>
</h3>
<p>Plotting a <code>rmf_4d_array</code> with <code><a href="../reference/rmf_plot.rmf_4d_array.html">rmf_plot.rmf_4d_array()</a></code> works much like plotting a <code>rmf_3d_array</code>: the user must supply a <code>i</code>, <code>j</code> or <code>k</code> integer. Additionally, a <code>l</code> integer must be supplied to subset the 4th dimension. If not present, the last time step will be plotted.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.fhd"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_hed.html">rmf_read_hed</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis_ws</span>, binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">hed</span>, dis <span class="op">=</span> <span class="va">dis_ws</span>, bas <span class="op">=</span> <span class="va">bas_ws</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; Warning: Plotting final time step results.</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">hed</span>, dis <span class="op">=</span> <span class="va">dis_ws</span>, bas <span class="op">=</span> <span class="va">bas_ws</span>, j <span class="op">=</span> <span class="fl">5</span>, l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
<p>If <code>i</code>, <code>j</code> and <code>k</code> are supplied and no <code>l</code> is supplied, a time-series is plotted of cell ijk:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">hed</span>, dis <span class="op">=</span> <span class="va">dis_ws</span>, i <span class="op">=</span> <span class="fl">20</span>, j <span class="op">=</span> <span class="fl">25</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="rmf_list" class="section level2">
<h2 class="hasAnchor">
<a href="#rmf_list" class="anchor"></a><code>rmf_list</code>
</h2>
<p>When a <code>rmf_list</code> is plotted, it is converted to a <code>rmf_3d_array</code> using <code><a href="../reference/rmf_as_array.html">rmf_as_array()</a></code> with <code>sparse = FALSE</code>. There are three arguments in <code><a href="../reference/rmf_plot.rmf_list.html">rmf_plot.rmf_list()</a></code> that you need to know about.</p>
<p>First, the <code>variable</code> argument, which is either an integer or a character name, specifies which column of the <code>rmf_list</code> to plot. The default, <code>'id'</code>, does not plot a variable but the locations of the cells in the <code>rmf_list</code>.</p>
<p>Secondly, <code>active_only</code> is a logical dictating how to handle the cells not present in the <code>rmf_list</code>. The default (<code>FALSE</code>) sets all non-active cells to 0. If <code>TRUE</code>, these cells are set to <code>NA</code>.</p>
<p>Lastly, the <code>fun</code> argument indicates how to handle duplicate cells. In a <code>rmf_list</code>, multiple instances of the same cell may appear. For instance, there can be multiple wells in a single MODFLOW cell. When plotting a variable, the <code>fun</code> argument specifies how to aggregate these values. The default is <code>sum</code>, but you can specify any function that returns a single numeric from one or more values (e.g. <code>mean</code>).</p>
<p>Since <code>rmf_plot.rmf_list</code> eventually calls <code>rmf_plot.rmf_3d_array</code> you can pass arguments for the latter as well.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, 
                 j <span class="op">=</span> <span class="fl">5</span>, 
                 k <span class="op">=</span> <span class="fl">1</span>, 
                 q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">1500</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_create_list.html">rmf_create_list</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">ls</span>, dis <span class="op">=</span> <span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">ls</span>, dis <span class="op">=</span> <span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span>, active_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-15-2.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">ls</span>, dis <span class="op">=</span> <span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span>, variable <span class="op">=</span> <span class="st">'q'</span>, active_only <span class="op">=</span> <span class="cn">TRUE</span>, gridlines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-15-3.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># fun = mean, notice change in scale</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">ls</span>, dis <span class="op">=</span> <span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span>, variable <span class="op">=</span> <span class="st">'q'</span>, active_only <span class="op">=</span> <span class="cn">TRUE</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-15-4.png" width="700"></p>
</div>
</div>
<div id="plotting-boundary-condition-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-boundary-condition-packages" class="anchor"></a>Plotting boundary condition packages</h1>
<p>As discussed in the <a href="boundary_conditions.html">vignette on boundary conditions</a>, MODFLOW boundary conditions can be grouped into those representing continuous spatial features and those representing discrete spatial features. The former will be plotted by <code>rmf_plot.rmf_2d_array</code>; the latter by <code>rmf_plot.rmf_list</code>. By default, the last stress-period is plotted; this can be overwritten by setting the <code>kper</code> argument. The variables which can be plotted depend on the package.</p>
<div id="continuous-boundary-conditions" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-boundary-conditions" class="anchor"></a>Continuous boundary conditions</h2>
<p>For continuous boundary conditions, the S3 plotting methods are simple wrappers for <code>rmf_plot.rmf_2d_array</code> with an additional <code>kper</code> and <code>variable</code> argument. The <code>variable</code> is set to sensible defaults for every package, e.g. <code>'recharge'</code> for the RCH package.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">dis_ws</span><span class="op">$</span><span class="va">nrow</span><span class="op">*</span><span class="va">dis_ws</span><span class="op">$</span><span class="va">ncol</span>, mean <span class="op">=</span> <span class="fl">0.0002</span>, sd <span class="op">=</span> <span class="fl">0.00008</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_create_array.html">rmf_create_array</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dis_ws</span><span class="op">$</span><span class="va">nrow</span>, <span class="va">dis_ws</span><span class="op">$</span><span class="va">ncol</span><span class="op">)</span>, kper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_create_rch.html">rmf_create_rch</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis_ws</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">rch</span>, dis <span class="op">=</span> <span class="va">dis_ws</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="discrete-boundary-conditions" class="section level2">
<h2 class="hasAnchor">
<a href="#discrete-boundary-conditions" class="anchor"></a>Discrete boundary conditions</h2>
<p>Concerning the discrete boundary conditions, the respective S3 plotting methods will set sensible defaults for the <code>rmf_plot.rmf_list</code> arguments. By default, <code>variable = 'id'</code> which plots the locations of the boundary condition cells; <code>active_only = TRUE</code> and the <code>fun</code> argument is set based on the variable that’s plotted which can differ between boundary conditions. In general, if the variable is conductance, <code>fun = sum</code>, otherwise <code>fun = mean</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">riv_ws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.riv"</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="../reference/rmf_read_riv.html">rmf_read_riv</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis_ws</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">riv_ws</span>, dis <span class="op">=</span> <span class="va">dis_ws</span>, k <span class="op">=</span> <span class="fl">1</span>, variable <span class="op">=</span> <span class="st">'conductance'</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div id="plotting-flow-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-flow-packages" class="anchor"></a>Plotting flow packages</h1>
<p>There are no S3 plotting methods for the BCF, LPF and NWT packages. Simply plot the arrays you want by calling <code>rmf_plot</code> on them directly:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lpf_ws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"water-supply-problem.lpf"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read_lpf.html">rmf_read_lpf</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis_ws</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">lpf_ws</span><span class="op">$</span><span class="va">hk</span>, dis <span class="op">=</span> <span class="va">dis_ws</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>For the HUF package however, there is a S3 plotting method: <code><a href="../reference/rmf_plot.huf.html">rmf_plot.huf()</a></code>. By default, it plots the hydrogeological units (hgu’s) using <code>type = 'factor'</code>. The <code>levels</code> argument is set to the names of the hgu’s provided by <code>huf$hgunam</code>. You can select rows, columns &amp; layer with <code>i</code>, <code>j</code> &amp; <code>k</code> as with normal <code>rmf_plot</code> functions. You can subset prefered hgu’s with the <code>hgu</code> argument which accepts either integers or character names of the hgu to plot. By default, the mask object is provided by <code><a href="../reference/rmf_convert_huf_to_mask.html">rmf_convert_huf_to_mask()</a></code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># No example problem with HUF package atm</span></code></pre></div>
</div>
<div id="plotting-output" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-output" class="anchor"></a>Plotting output</h1>
<p>Plotting output is shown in <a href="output.html">the vignette on output handling</a>.</p>
</div>
<div id="plotting-modflow-models" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-modflow-models" class="anchor"></a>Plotting MODFLOW models</h1>
<p>To quickly have a glance at an entire MODFLOW model that’s been read in, <code>rmf_plot</code> also has a S3 method for the <code>modflow</code> class. This plots the IBOUND array and the discrete boundary condition packages that are active. Continuous boundary conditions like RCH and EVT are not plotted since that would overwhelm to plot. You have to select a i, j or k section to plot:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"rocky-mountain-arsenal.nam"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read.html">rmf_read</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">m</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>If you wish to omit a certain package, specify the <code>omit</code> argument which takes a character vector as input. Note that it requires MODFLOW abbreviations for the packages, like the <code>ftype</code> in the NAME file:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">m</span>, k <span class="op">=</span> <span class="fl">1</span>, omit <span class="op">=</span> <span class="st">'CHD'</span>, gridlines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>In some models, not all boundary conditions are present in all layers. For example, wells are often present in deeper layers. Instead of plotting all layers separately to view them, we can reproject all boundary condition cells to the current layer when the <code>k</code> index is given by setting <code>to_k = TRUE</code>. Note that the IBOUND is not reprojected.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span><span class="op">(</span><span class="st">"example-model.nam"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_read.html">rmf_read</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># nothing in layer 2</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">m</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># force showing all </span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">m</span>, k <span class="op">=</span> <span class="fl">2</span>, to_k <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-22-2.png" width="700"></p>
</div>
<div id="underlying-code" class="section level1">
<h1 class="hasAnchor">
<a href="#underlying-code" class="anchor"></a>Underlying code</h1>
<p>When you call <code>rmf_plot</code> on a RMODFLOW object, it is converted to a <code>tibble</code> data frame and subsequently plotted using ggplot2. You can do this yourself for maximum flexibility:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co"># rmf_plot(m$dis$top, dis = m$dis) is basically:</span>

<span class="fu"><a href="../reference/rmf_as_tibble.html">rmf_as_tibble</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, dis <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">dis</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">id</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rogiersbart.github.io/">Bart Rogiers</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
