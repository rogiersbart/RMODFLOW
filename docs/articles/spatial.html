<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial functions • RMODFLOW</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Spatial functions">
<meta property="og:description" content="RMODFLOW">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RMODFLOW</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RMODFLOW.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/boundary_conditions.html">Boundary conditions</a>
    </li>
    <li>
      <a href="../articles/input_data_structure.html">Structure of input data</a>
    </li>
    <li>
      <a href="../articles/output.html">Handling MODFLOW output</a>
    </li>
    <li>
      <a href="../articles/parameters.html">MODFLOW parameters</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting in RMODFLOW</a>
    </li>
    <li>
      <a href="../articles/spatial.html">Spatial functions</a>
    </li>
    <li>
      <a href="../articles/top_level.html">Top-level functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rogiersbart/RMODFLOW/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="spatial_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spatial functions</h1>
                        <h4 class="author">Cas Neyens</h4>
            
            <h4 class="date">2021-10-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rogiersbart/RMODFLOW/blob/master/vignettes/spatial.Rmd"><code>vignettes/spatial.Rmd</code></a></small>
      <div class="hidden name"><code>spatial.Rmd</code></div>

    </div>

    
    
<pre><code>## 
! {RMODFLOW} is still in its experimental lifecycle stage.
## 
! Use at your own risk, and submit issues here:
## 
! &lt;https://github.com/rogiersbart/RMODFLOW/issues&gt;</code></pre>
<p>RMODFLOW has several functions to handle conversions from and to spatial objects. Spatial data in MODFLOW comes in two forms, discrete and continuous. This resembles the two major types of geographic data: vector and raster. RMODFLOW supports the conversion from and to <code>sf</code>, <code>stars</code> and <code>raster</code> objects. RMODFLOW uses a <code>prj</code> object to define the origin, rotation and coordinate reference system of the model and uses this object in spatial functions.</p>
<div id="the-rmodflow-projection-object" class="section level1">
<h1 class="hasAnchor">
<a href="#the-rmodflow-projection-object" class="anchor"></a>The RMODFLOW projection object</h1>
<p>If the MODFLOW model represents a real-world area, it can be georeferenced. This is done in RMODFLOW with the <code>prj</code> object. In essence, the <code>prj</code> object is a list with three components:</p>
<ol style="list-style-type: decimal">
<li>The origin: the real-world XY(Z) coordinates of the bottomleft corner of the model</li>
<li>The rotation angle around this corner</li>
<li>The coordinate reference system in which these coordinates are defined</li>
</ol>
<p>You can create a <code>prj</code> object from scratch using <code><a href="../reference/rmf_create_prj.html">rmf_create_prj()</a></code>. It needs three arguments: <code>origin</code> is a numeric vector with the X, Y and Z coordinates of the bottomleft corner. If no Z coordinate is supplied, it is set to zero. The default is <code><a href="https://rdrr.io/r/base/c.html">c(0, 0, 0)</a></code>. Note that these coordinates should be in length units defined in the <code>crs</code> argument. The second argument is <code>rotation</code>, specifying the rotation angle around the bottomleft corner in degrees counterclockwise. It defaults to 0. The third argument is <code>crs</code> which sets the coordinate reference system. It can take any value supported by <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html">sf::st_crs</a></code>, e.g. EPSG codes, proj4string or WKT formats. If no crs is defined it should be set to <code>NA</code> (the default). In addition to those three arguments, <code><a href="../reference/rmf_create_prj.html">rmf_create_prj()</a></code> has a <code>ulcoordinate</code> argument which is a logical specifying that the supplied <code>origin</code> vector represents the topleft corner instead of the bottomleft (default is FALSE) and <code>nodecoordinate</code> which if set to TRUE specifies that the supplied <code>origin</code> vector represents the coordinates of the <em>nodal cell center</em> instead of the <em>cell corner</em> as it is by default. Note that if any of these two arguments are set to TRUE, a <code>dis</code> object needs to be supplied as well to convert <code>origin</code> to the bottomleft corner. The resulting <code>origin</code> values in the <code>prj</code> object always represent the bottomleft cell corner of the model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">prj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_prj.html">rmf_create_prj</a></span><span class="op">(</span>origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">152082</span>, <span class="fl">168000.2</span><span class="op">)</span>, rotation <span class="op">=</span> <span class="op">-</span><span class="fl">12</span>, crs <span class="op">=</span> <span class="fl">31370</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; RMODFLOW Projection object: </span>
<span class="co">#&gt; Origin coordinates (x y z) of the lowerleft corner: </span>
<span class="co">#&gt;   152082 168000.2 0 </span>
<span class="co">#&gt; Grid rotation (degrees counterclockwise): </span>
<span class="co">#&gt;   -12 </span>
<span class="co">#&gt; Coordinate Reference System: </span>
<span class="co">#&gt;   EPSG: 31370 </span>
<span class="co">#&gt;   proj4string: +proj=lcc +lat_0=90 +lon_0=4.36748666666667 +lat_1=51.1666672333333 +lat_2=49.8333339 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +units=m +no_defs</span></code></pre></div>
<p>The <code>prj</code> object can be placed in an existing <code>dis</code> object using <code>rmf_set_prj</code> or by supplying <code>prj</code> to a <code>rmf_create_dis</code> call:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_dis.html">rmf_create_dis</a></span><span class="op">(</span>prj <span class="op">=</span> <span class="va">prj</span><span class="op">)</span>
<span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prj_auxiliary.html">rmf_set_prj</a></span><span class="op">(</span><span class="va">dis</span>, <span class="va">prj</span><span class="op">)</span>
<span class="co">#&gt; Warning: Overwriting existing prj object in dis object</span></code></pre></div>
<p>Whenever a <code>prj</code> argument is needed by a RMODFLOW function it is obtained from the <code>dis</code> object (if supplied) using <code>rmf_get_prj</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, <span class="va">dis</span><span class="op">)</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Alternatively, you can specify the <code>prj</code> argument directly in these functions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, <span class="va">dis</span>, prj <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Using this approach, the <code>prj</code> object is part of the <code>dis</code> object and is by default directly obtained in function calls using <code>rmf_get_prj</code> although all those functions allow specifying <code>prj</code> directly as well.</p>
<p>RMODFLOW projection information is written to the header comments of the DIS file when writing a <code>dis</code> object containing <code>prj</code> using <code>rmf_write_dis</code>. The structure of the RMODFLOW projection information is as follows:</p>
<pre><code>#&gt; # Start RMODFLOW projection information
#&gt; # Upper left corner: (152289.911690818, 168978.347600734)
#&gt; # Lower left corner: (152082, 168000.2)
#&gt; # Upper right corner: (153268.059291552, 168770.435909916)
#&gt; # Lower right corner: (153060.147600734, 167792.288309182)
#&gt; # Grid angle (in degrees counterclockwise): -12
#&gt; # Z coordinate lower left corner: 0
#&gt; # epsg: 31370
#&gt; # End RMODFLOW projection information</code></pre>
<p>If a crs is present, the EPSG, proj4string or WKT information is written (in that order of importance). If no crs is present a proj4string value of NA is written. Alternatively, you can ‘inject’ RMODFLOW style projection information into the header comments of an existing DIS file using <code><a href="../reference/prj_auxiliary.html">rmf_set_prj(file, dis, prj)</a></code> where <code>file</code> is the path to the DIS file.</p>
<p>When reading in a DIS file, projection information is checked in multiple locations. Firstly, the header comments in the DIS file are checked for RMODFLOW style projection information. If not present, ModelMuse style projection is checked. If that’s also not available, MODFLOW-OWHM style projection information is checked in the first data set of the DIS object. If <code>rmf_read</code> is used to read in an entire model and a usgs.model.reference file is present in the same directory as the NAME file (as should be the case for usgs.reference.model files), the projection information is read from that file using <code><a href="../reference/rmf_read_usgs_model_reference.html">rmf_read_usgs_model_reference()</a></code> which takes precedence over the other formats.</p>
<p>Most crs formats have length units defined. If they differ from the defined MODFLOW length units (<code>dis$lenuni</code>), RMODFLOW converts the latter on-the-fly whenever a <code>prj</code> is supplied with a crs element that has length units. This conversion is used in e.g. plotting or functions where coordinates are returned:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dis</span><span class="op">$</span><span class="va">lenuni</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># ft</span>
<span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, <span class="va">dis</span>, prj <span class="op">=</span> <span class="va">prj</span><span class="op">)</span> <span class="co"># crs in prj is defined in m</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="conversion-to-spatial-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#conversion-to-spatial-objects" class="anchor"></a>Conversion to spatial objects</h1>
<p>RMODFLOW provides several S3 functions to convert its base classes (<code>rmf_list</code> and <code>rmf_2d/3d/4d_array</code>) to spatial objects. Conversion can be to <code>sf</code>, <code>stars</code> or <code>raster</code> objects. The latter is only possible for non-rotated regular grids.</p>
<p>Conversion to <code>sf</code> is done with <code>rmf_as_sf</code> which takes as input either an RMODFLOW array or list object, the dis argument and an optional prj object (by default taken from the dis argument). By default it returns polygon geometries representing the grid cells. If the <code>as_points</code> argument is set to <code>TRUE</code>, point geometries are returned representing the cell-centered nodes. In addition to the geometries and values, an <code>id</code> column is returned with either the <code>r</code> based or <code>modflow</code> based array index of the cell/node depending on the <code>id</code> argument (<code>r</code> by default):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_as_sf.html">rmf_as_sf</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, <span class="va">dis</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 100 features and 2 fields</span>
<span class="co">#&gt; Geometry type: POLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 152082 ymin: 167936.8 xmax: 152443.5 ymax: 168298.3</span>
<span class="co">#&gt; Projected CRS: Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    value  id                       geometry</span>
<span class="co">#&gt; 1      0  10 POLYGON ((152082 168000.2, ...</span>
<span class="co">#&gt; 2      0  20 POLYGON ((152111.8 167993.9...</span>
<span class="co">#&gt; 3      0  30 POLYGON ((152141.6 167987.5...</span>
<span class="co">#&gt; 4      0  40 POLYGON ((152171.4 167981.2...</span>
<span class="co">#&gt; 5      0  50 POLYGON ((152201.3 167974.9...</span>
<span class="co">#&gt; 6      0  60 POLYGON ((152231.1 167968.5...</span>
<span class="co">#&gt; 7      0  70 POLYGON ((152260.9 167962.2...</span>
<span class="co">#&gt; 8      0  80 POLYGON ((152290.7 167955.8...</span>
<span class="co">#&gt; 9      0  90 POLYGON ((152320.5 167949.5...</span>
<span class="co">#&gt; 10     0 100 POLYGON ((152350.3 167943.2...</span>

<span class="op">(</span><span class="va">sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_as_sf.html">rmf_as_sf</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, <span class="va">dis</span>, as_points <span class="op">=</span> <span class="cn">TRUE</span>, id <span class="op">=</span> <span class="st">'modflow'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 100 features and 2 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 152100.1 ymin: 167954.9 xmax: 152425.4 ymax: 168280.3</span>
<span class="co">#&gt; Projected CRS: Belge 1972 / Belgian Lambert 72</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    value  id                  geometry</span>
<span class="co">#&gt; 1      0  91 POINT (152100.1 168011.9)</span>
<span class="co">#&gt; 2      0  92 POINT (152129.9 168005.6)</span>
<span class="co">#&gt; 3      0  93 POINT (152159.7 167999.3)</span>
<span class="co">#&gt; 4      0  94 POINT (152189.5 167992.9)</span>
<span class="co">#&gt; 5      0  95 POINT (152219.3 167986.6)</span>
<span class="co">#&gt; 6      0  96 POINT (152249.1 167980.3)</span>
<span class="co">#&gt; 7      0  97   POINT (152279 167973.9)</span>
<span class="co">#&gt; 8      0  98 POINT (152308.8 167967.6)</span>
<span class="co">#&gt; 9      0  99 POINT (152338.6 167961.2)</span>
<span class="co">#&gt; 10     0 100 POINT (152368.4 167954.9)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sf</span><span class="op">)</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>At its core, <code>rmf_as_sf</code> first converts to a <code>stars</code> object using <code>rmf_as_stars</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_as_stars.html">rmf_as_stars</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">botm</span>, <span class="va">dis</span><span class="op">)</span>
<span class="co">#&gt; stars object with 3 dimensions and 2 attributes</span>
<span class="co">#&gt; attribute(s):</span>
<span class="co">#&gt;        Min. 1st Qu. Median  Mean 3rd Qu. Max.</span>
<span class="co">#&gt; value   -30  -30.00  -20.0 -20.0  -10.00  -10</span>
<span class="co">#&gt; id        1   75.75  150.5 150.5  225.25  300</span>
<span class="co">#&gt; dimension(s):</span>
<span class="co">#&gt;       from to offset   delta                       refsys point</span>
<span class="co">#&gt; x        1 10 152082 29.8139 Belge 1972 / Belgian Lamb... FALSE</span>
<span class="co">#&gt; y        1 10 168000 29.8139 Belge 1972 / Belgian Lamb... FALSE</span>
<span class="co">#&gt; layer    1  3     NA      NA                           NA    NA</span>
<span class="co">#&gt;                          values x/y</span>
<span class="co">#&gt; x                          NULL [x]</span>
<span class="co">#&gt; y                          NULL [y]</span>
<span class="co">#&gt; layer layer_1, layer_2, layer_3    </span>
<span class="co">#&gt; sheared raster with parameters: 6.33714833612748 -6.33714833612748</span></code></pre></div>
<p>To convert to <code>raster</code>, use <code>rmf_as_raster</code> which first calls <code>rmf_as_stars</code> and then converts to a <code>raster</code> object. Note that this only works for regular non-rotated rasters:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_as_raster.html">rmf_as_raster</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">botm</span>, <span class="va">dis</span><span class="op">)</span>
<span class="co">#&gt; Error in asMethod(object): only regular rasters can be converted to Raster* objects</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_as_raster.html">rmf_as_raster</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">top</span>, <span class="va">dis</span>, prj <span class="op">=</span> <span class="fu"><a href="../reference/rmf_create_prj.html">rmf_create_prj</a></span><span class="op">(</span>origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">152082</span>, <span class="fl">168000.2</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">31370</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; class      : RasterBrick </span>
<span class="co">#&gt; dimensions : 10, 10, 100, 2  (nrow, ncol, ncell, nlayers)</span>
<span class="co">#&gt; resolution : 30.48, 30.48  (x, y)</span>
<span class="co">#&gt; extent     : 152082, 152386.8, 168000.2, 168305  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=lcc +lat_0=90 +lon_0=4.36748666666667 +lat_1=51.1666672333333 +lat_2=49.8333339 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +units=m +no_defs </span>
<span class="co">#&gt; source     : memory</span>
<span class="co">#&gt; names      : value,  id </span>
<span class="co">#&gt; min values :     0,   1 </span>
<span class="co">#&gt; max values :     0, 100</span></code></pre></div>
</div>
<div id="conversion-to-rmodflow-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#conversion-to-rmodflow-objects" class="anchor"></a>Conversion to RMODFLOW objects</h1>
<p>RMODFLOW can convert <code>sf</code>, <code>stars</code> and <code>raster</code> objects to <code>rmf_list</code> and <code>rmf_2d/3d/4d_array</code> objects using S3 functions <code>rmf_as_list</code> and <code>rmf_as_array</code>.</p>
<p><code>rmf_as_list.sf</code> uses <code><a href="https://r-spatial.github.io/sf/reference/st_join.html">sf::st_join</a></code> to find the MODFLOW grid indices corresponding to the <code>sf</code> object. By default, the geometrical operator is set to <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">sf::st_intersects</a></code> but this can be any kind described in <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">?sf::st_intersects</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_dis.html">rmf_create_dis</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># point</span>
<span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">312</span><span class="op">)</span><span class="op">)</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">850</span>, <span class="fl">566</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">400</span>, <span class="op">-</span><span class="fl">300</span><span class="op">)</span>, geom <span class="op">=</span> <span class="va">pts</span><span class="op">)</span>

<span class="co"># convert to rmf_list</span>
<span class="op">(</span><span class="va">rlst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_as_list.html">rmf_as_list</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">dis</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; RMODFLOW list with 6 features and 1 variable </span>
<span class="co">#&gt; Not representing stress period data </span>
<span class="co">#&gt;   i j k    q</span>
<span class="co">#&gt; 1 7 2 1 -500</span>
<span class="co">#&gt; 2 6 5 1 -400</span>
<span class="co">#&gt; 3 6 6 1 -400</span>
<span class="co">#&gt; 4 5 5 1 -400</span>
<span class="co">#&gt; 5 5 6 1 -400</span>
<span class="co">#&gt; 6 5 9 1 -300</span>

<span class="co"># polygon</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">120</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">760</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">800</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">120</span><span class="op">)</span><span class="op">)</span>
<span class="va">pol1</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span><span class="op">)</span>

<span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>head <span class="op">=</span> <span class="fl">15</span>, geom <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">pol1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># convert to rmf_list and plot</span>
<span class="co"># op = sf::st_intersects</span>
<span class="fu"><a href="../reference/rmf_as_list.html">rmf_as_list</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">dis</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span>, grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">obj</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>, fill <span class="op">=</span> <span class="st">'yellow'</span><span class="op">)</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># op = sf::st_covers</span>
<span class="fu"><a href="../reference/rmf_as_list.html">rmf_as_list</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">dis</span>, op <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="va"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_covers</a></span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span><span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span>, grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">obj</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>, fill <span class="op">=</span> <span class="st">'yellow'</span><span class="op">)</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
<p>Note that when a point geometry is located on the edges of cells, depending on the used operator <code>op</code>, one or more cells might be returned. Although correct topological behaviour, this is not always desirable. E.g. if a well should be attributed to a single cell (unless the discharge is also recalculated):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 4 cells selected for second point on cell edges</span>
<span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">400</span>, <span class="op">-</span><span class="fl">300</span><span class="op">)</span>, geom <span class="op">=</span> <span class="va">pts</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_as_list.html">rmf_as_list</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">dis</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rmf_plot.html">rmf_plot</a></span><span class="op">(</span> <span class="va">dis</span>, k <span class="op">=</span> <span class="fl">1</span>, grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">obj</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span></code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>The user should be aware of this and set <code>op</code> accordingly.</p>
<p><code>rmf_as_array.sf</code> rasterizes a <code>sf</code> object to a <code>rmf_array</code> using <code><a href="https://r-spatial.github.io/stars/reference/st_rasterize.html">stars::st_rasterize</a></code> which in turn uses GDALRasterize.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sfc</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">200</span><span class="op">)</span><span class="op">)</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">750</span>, <span class="fl">800</span><span class="op">)</span><span class="op">)</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">700</span>, <span class="fl">850</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">400</span>, <span class="op">-</span><span class="fl">300</span><span class="op">)</span>, geom <span class="op">=</span> <span class="va">sfc</span><span class="op">)</span>
<span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_dis.html">rmf_create_dis</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_as_array.html">rmf_as_array</a></span><span class="op">(</span><span class="va">obj</span>, dis <span class="op">=</span> <span class="va">dis</span>, select <span class="op">=</span> <span class="st">'q'</span><span class="op">)</span>
<span class="co">#&gt; RMODFLOW 2d array with 10 rows and 10 columns, representing the i &amp; j dimensions. </span>
<span class="co">#&gt; Not representing stress period data </span>
<span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span>
<span class="co">#&gt;  [1,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [2,]    0    0    0    0    0    0    0 -300    0     0</span>
<span class="co">#&gt;  [3,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [4,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [5,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [6,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [7,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [8,]    0 -500    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [9,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt; [10,]    0    0    0    0    0    0    0    0    0     0</span>

<span class="co"># add values at same location</span>
<span class="fu"><a href="../reference/rmf_as_array.html">rmf_as_array</a></span><span class="op">(</span><span class="va">obj</span>, dis <span class="op">=</span> <span class="va">dis</span>, select <span class="op">=</span> <span class="st">'q'</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'MERGE_ALG=ADD'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; RMODFLOW 2d array with 10 rows and 10 columns, representing the i &amp; j dimensions. </span>
<span class="co">#&gt; Not representing stress period data </span>
<span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span>
<span class="co">#&gt;  [1,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [2,]    0    0    0    0    0    0    0 -700    0     0</span>
<span class="co">#&gt;  [3,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [4,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [5,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [6,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [7,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [8,]    0 -500    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [9,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt; [10,]    0    0    0    0    0    0    0    0    0     0</span></code></pre></div>
<p>As an alternative, you can convert the <code>sf</code> object to a <code>rmf_list</code> and convert the resulting object using <code>rmf_as_array</code>. Results may differ:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># alternative</span>
<span class="fu"><a href="../reference/rmf_as_list.html">rmf_as_list</a></span><span class="op">(</span><span class="va">obj</span>, dis <span class="op">=</span> <span class="va">dis</span>, select <span class="op">=</span> <span class="st">'q'</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_as_array.html">rmf_as_array</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span>
<span class="co">#&gt; RMODFLOW 2d array with 10 rows and 10 columns, representing the i &amp; j dimensions. </span>
<span class="co">#&gt; Not representing stress period data </span>
<span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span>
<span class="co">#&gt;  [1,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [2,]    0    0    0    0    0    0 -300 -700    0     0</span>
<span class="co">#&gt;  [3,]    0    0    0    0    0    0    0 -400    0     0</span>
<span class="co">#&gt;  [4,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [5,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [6,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [7,]    0    0    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [8,] -500 -500    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt;  [9,] -500 -500    0    0    0    0    0    0    0     0</span>
<span class="co">#&gt; [10,]    0    0    0    0    0    0    0    0    0     0</span></code></pre></div>
<p>Converting a <code>stars</code> object to an array uses <code><a href="https://r-spatial.github.io/stars/reference/st_warp.html">stars::st_warp</a></code> if <code>resample = TRUE</code>. This should be used when the dimensions and resolution of the MODFLOW grid and the <code>stars</code> object do not match. The values will be resampled using the specified <code>method</code>. For possible methods, see <code><a href="https://r-spatial.github.io/stars/reference/st_warp.html">?stars::st_warp</a></code> (default is bilinear interpolation). If the dimensions and resolution do coincide, <code>resample</code> should be set to <code>FALSE</code> which simply sets the values in the <code>rmf_array</code> to those in the <code>stars</code> object. Conversion from <code>raster</code> objects uses the same functions but first converts <code>raster</code> to <code>stars</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_array.html">rmf_create_array</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nrow</span>, <span class="va">dis</span><span class="op">$</span><span class="va">ncol</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dis</span><span class="op">$</span><span class="va">nrow</span>, <span class="va">dis</span><span class="op">$</span><span class="va">ncol</span><span class="op">)</span><span class="op">)</span>
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_as_stars.html">rmf_as_stars</a></span><span class="op">(</span><span class="va">r</span>, dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span>

<span class="fu"><a href="../reference/rmf_as_array.html">rmf_as_array</a></span><span class="op">(</span><span class="va">s</span>, dis <span class="op">=</span> <span class="va">dis</span>, resample <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; RMODFLOW 2d array with 10 rows and 10 columns, representing the i &amp; j dimensions. </span>
<span class="co">#&gt; Not representing stress period data </span>
<span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span>
<span class="co">#&gt;  [1,]    1   11   21   31   41   51   61   71   81    91</span>
<span class="co">#&gt;  [2,]    2   12   22   32   42   52   62   72   82    92</span>
<span class="co">#&gt;  [3,]    3   13   23   33   43   53   63   73   83    93</span>
<span class="co">#&gt;  [4,]    4   14   24   34   44   54   64   74   84    94</span>
<span class="co">#&gt;  [5,]    5   15   25   35   45   55   65   75   85    95</span>
<span class="co">#&gt;  [6,]    6   16   26   36   46   56   66   76   86    96</span>
<span class="co">#&gt;  [7,]    7   17   27   37   47   57   67   77   87    97</span>
<span class="co">#&gt;  [8,]    8   18   28   38   48   58   68   78   88    98</span>
<span class="co">#&gt;  [9,]    9   19   29   39   49   59   69   79   89    99</span>
<span class="co">#&gt; [10,]   10   20   30   40   50   60   70   80   90   100</span></code></pre></div>
<p>Conversion from <code>stars</code> to <code>rmf_list</code> is intended for <code>stars</code> objects with geometry dimensions (e.g.<code>sf</code> objects) and involves converting the <code>stars</code> object to <code>sf</code>.</p>
<p>These spatial-to-RMODFLOW functions can for example be used in pipelines to create boundary condition packages. Ultimately, these might evolve to functions that are tailored for specific stress packages, e.g. a <code>rmf_build_wel</code> function that creates a <code>wel</code> object directly from a <code>sf</code> input object without the intermediate conversion to <code>rmf_list</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># linestring</span>
<span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">150</span>,<span class="fl">312</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">500</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">850</span>, <span class="fl">566</span><span class="op">)</span><span class="op">)</span>
<span class="va">ls1</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_linestring</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span>
<span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">555</span><span class="op">)</span><span class="op">)</span>
<span class="va">ls2</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_linestring</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span>

<span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>conductance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>, stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, rbot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span>, geom <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">ls1</span>, <span class="va">ls2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_as_list.html">rmf_as_list</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span>, kper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmf_create_riv.html">rmf_create_riv</a></span><span class="op">(</span>dis <span class="op">=</span> <span class="va">dis</span><span class="op">)</span>
<span class="co">#&gt; RMODFLOW River Package object with: </span>
<span class="co">#&gt; 23 non-parameter river cells </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; RIV fluxes are not saved to a cell-by-cell flow budget file </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Summary of the first 15 defined river cells: </span>
<span class="co">#&gt;    k  i j stage conductance rbot parameter   name</span>
<span class="co">#&gt; 1  1  7 2    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 2  1  7 3    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 3  1  7 4    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 4  1  6 4    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 5  1  6 5    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 6  1  6 6    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 7  1  5 5    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 8  1  5 6    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 9  1  5 7    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 10 1  5 8    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 11 1  5 9    -5         500   -6     FALSE list_1</span>
<span class="co">#&gt; 12 1 10 1    -2        1000   -5     FALSE list_1</span>
<span class="co">#&gt; 13 1 10 2    -2        1000   -5     FALSE list_1</span>
<span class="co">#&gt; 14 1  9 1    -2        1000   -5     FALSE list_1</span>
<span class="co">#&gt; 15 1  9 2    -2        1000   -5     FALSE list_1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Summary of the stress-period information: </span>
<span class="co">#&gt;   kper list_1</span>
<span class="co">#&gt; 1    1   TRUE</span></code></pre></div>
</div>
<div id="utility-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#utility-functions" class="anchor"></a>Utility functions</h1>
<p>There are several S3 utility functions dealing with the <code>prj</code> object which work on <code>dis</code> and <code>modflow</code> objects. In addition to <code>rmf_get_prj</code> and <code>rmf_set_prj</code> (discussed above), <code>rmf_has_prj</code> returns a logical depending on the presence of a <code>prj</code> object in a <code>dis</code> or <code>modflow</code> object. <code>rmf_transform_prj</code> switches the crs of a <code>prj</code> object, transforms the origin coordinates and returns the supplied <code>prj</code>, <code>dis</code> or <code>modflow</code> argument with these modifications.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_prj.html">rmf_create_prj</a></span><span class="op">(</span>origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">152082</span>, <span class="fl">168000.2</span><span class="op">)</span>, rotation <span class="op">=</span> <span class="op">-</span><span class="fl">12</span>, crs <span class="op">=</span> <span class="fl">31370</span><span class="op">)</span>
<span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmf_create_dis.html">rmf_create_dis</a></span><span class="op">(</span>prj <span class="op">=</span> <span class="va">prj</span><span class="op">)</span>
<span class="fu"><a href="../reference/prj_auxiliary.html">rmf_has_prj</a></span><span class="op">(</span><span class="va">dis</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="fu"><a href="../reference/prj_auxiliary.html">rmf_transform_prj</a></span><span class="op">(</span><span class="va">prj</span>, crs <span class="op">=</span> <span class="fl">3812</span><span class="op">)</span>
<span class="co">#&gt; RMODFLOW Projection object: </span>
<span class="co">#&gt; Origin coordinates (x y z) of the lowerleft corner: </span>
<span class="co">#&gt;   652081.9 668000.9 0 </span>
<span class="co">#&gt; Grid rotation (degrees counterclockwise): </span>
<span class="co">#&gt;   -12 </span>
<span class="co">#&gt; Coordinate Reference System: </span>
<span class="co">#&gt;   EPSG: 3812 </span>
<span class="co">#&gt;   proj4string: +proj=lcc +lat_0=50.797815 +lon_0=4.35921583333333 +lat_1=49.8333333333333 +lat_2=51.1666666666667 +x_0=649328 +y_0=665262 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs</span></code></pre></div>
<p>Lastly, the <code>rmf_extent</code> function returns a list with (1) the coordinates of the grid corners as a <code>data.frame</code> and (2) the bounding box of the grid as a <code>sf bbox</code> object:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmf_extent.html">rmf_extent</a></span><span class="op">(</span><span class="va">dis</span><span class="op">)</span>
<span class="co">#&gt; $corners</span>
<span class="co">#&gt;           x        y</span>
<span class="co">#&gt; ll 152082.0 168000.2</span>
<span class="co">#&gt; ul 152289.9 168978.3</span>
<span class="co">#&gt; ur 153268.1 168770.4</span>
<span class="co">#&gt; lr 153060.1 167792.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bbox</span>
<span class="co">#&gt;     xmin     ymin     xmax     ymax </span>
<span class="co">#&gt; 152082.0 167792.3 153268.1 168978.3</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rogiersbart.github.io/">Bart Rogiers</a>, Cas Neyens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
